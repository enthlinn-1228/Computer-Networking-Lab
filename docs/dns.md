# DNS 文档
域名系统 DNS 能够将域名转换为 IP 地址，它被设计为联机分布式数据库系统，并采用客户-服务器方式。
DNS 采用高速缓存来减轻查询压力，高速缓存用来存放最近查询过的域名以及从何处获得域名映射信息的记录。

## DNS 报文格式
![](https://github.com/woai3c/Computer-Networking-Lab/blob/master/imgs/dns-protocol-format.png)
## 解析过程
### 1. 主机向本地域名服务器查询一般采用递归查询。
如果主机询问的本地域名服务器不知道被查询域名的 IP 地址，那本地域名服务器就以 DNS 客户的身份继续向其他域名服务器发出查询请求报文。
因此，递归查询的返回结果要么是查找到的 IP 地址，要么是报错，即没查找到结果。

### 2. 本地域名服务器向根域名服务器的查询通常采用迭代查询
当根域名服务器收到本地域名服务器的查询时，要么给出所查询的 IP 地址，要么告诉本地域名服务器下一步应该向哪个顶级域名服务器查询，然后本地域名服务器继续
向顶级域名服务器查询。顶级域名服务器收到本地域名服务器的查询时，要么给出所查询的 IP 地址，要么告诉本地域名服务器下一步应该向哪个权限域名服务器查询，
本地域名服务器就这样进行迭代查询，最后把所查询到的结果返回给发起查询的主机。当然，本地域名服务器也能采用递归方式查询，取决于最初的查询报文的设置。

![](https://github.com/woai3c/Computer-Networking-Lab/blob/master/imgs/dns-example.png)

## 名词解释
### 域名
任何一个连接在互联网上的主机或路由器，都有一个唯一的层次结构的名字，称为域名，域名总共不超过 255 个字符。
DNS 不规定一个域名需要包含多少个下级域名，也不规定每一级的域名代表什么意思。

![](https://github.com/woai3c/Computer-Networking-Lab/blob/master/imgs/dns-name-format.png)

### 域名分类
在国家顶级域名下注册的二级域名均由该国家自行确定。假如某个单位拥有自己的域名，它就可以自行决定是否要进一步划分其下属的子域。
#### 1. 国家顶级域名
cn us uk...
#### 2. 通用顶级域名
com net org int edu gov mil...
#### 3. 基础结构域名
这种域名只有一个，即 arpa，用于反向域名解析，又叫反向域名。

![](https://github.com/woai3c/Computer-Networking-Lab/blob/master/imgs/dns-space.png)

### 域名服务器类型
![](https://github.com/woai3c/Computer-Networking-Lab/blob/master/imgs/dns-server.png)
#### 1. 根域名服务器
最高层次、最重要的域名服务器，根域名服务器知道所有顶级域名服务器的域名和地址。本地域名服务器如果解析不了域名，就要向根域名服务器求助。
大多数情况下，根域名服务器会告诉本地域名服务器下一步应该找哪个顶级域名服务器进行查询。
#### 2. 顶级域名服务器
这些服务器负责管理在该顶级域名服务器注册的所有二级域名。

#### 3. 权限域名服务器
DNS 采用划分区的方式来管理域名系统，每一个区设置相应的权限域名服务器，用来保存该区中的所有主机的域名到 IP 地址的映射。
区是 DNS 服务器实际管辖范围，区不能大于域。当一个权限域名服务器不能给出结果时，就会告诉客户下一步要找哪个权限域名服务器。

#### 4. 本地域名服务器
当一台主机发出 DNS 请求时，这个请求就会发往本地域名服务器。每一个互联网提供者 ISP，或者一个大学甚至一个系，都可以拥有一个本地域名服务器。
为了提高 DNS 可靠性，DNS 会把数据复制到几个域名服务器来保存。如果主域名服务器出故障了，其他的辅助域名服务器可以保证 DNS 查询工作不会中断。
